<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Reset your Moueene password" />
    <title>Forgot Password - Moueene</title>
    <link rel="icon" type="image/png" href="../logo.png" />
    <link rel="stylesheet" href="../assets/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <nav class="navbar">
          <a href="../index.html" class="logo">
            <img src="../logo.png" alt="Moueene Logo" />
          </a>
          <ul class="nav-menu">
            <li><a href="../index.html">Home</a></li>
            <li><a href="services.html">Services</a></li>
            <li><a href="providers.html">Providers</a></li>
            <li><a href="how-it-works.html">How It Works</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
          <div class="nav-buttons">
            <a href="login.html" class="btn btn-outline">Login</a>
            <a href="register.html" class="btn btn-primary">Sign Up</a>
          </div>
          <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </nav>
      </div>
    </header>

    <!-- Forgot Password Section -->
    <section class="auth-section">
      <div class="container">
        <div class="auth-container">
          <div class="auth-card">
            <div class="auth-header">
              <div
                style="
                  width: 80px;
                  height: 80px;
                  background: linear-gradient(
                    135deg,
                    var(--gradient-start),
                    var(--gradient-end)
                  );
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  margin: 0 auto 20px;
                "
              >
                <i
                  class="fas fa-lock"
                  style="font-size: 2rem; color: white"
                ></i>
              </div>
              <h1>Forgot Password?</h1>
              <p>
                No worries! Enter your email address and we'll send you a link
                to reset your password.
              </p>
            </div>

            <form class="auth-form" id="forgotPasswordForm">
              <div class="form-group">
                <label for="email">Email Address</label>
                <div class="input-group">
                  <i class="fas fa-envelope"></i>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    placeholder="Enter your email"
                    autocomplete="email"
                    required
                  />
                </div>
              </div>

              <button
                type="submit"
                class="btn btn-primary btn-lg"
                style="width: 100%"
              >
                <i class="fas fa-paper-plane" style="margin-right: 8px"></i>Send
                Reset Link
              </button>
            </form>

            <!-- Success Message (hidden by default) -->
            <div
              id="successMessage"
              style="display: none; text-align: center; padding: 30px 0"
            >
              <div
                style="
                  width: 80px;
                  height: 80px;
                  background: rgba(0, 201, 167, 0.1);
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  margin: 0 auto 20px;
                "
              >
                <i
                  class="fas fa-check"
                  style="font-size: 2rem; color: var(--primary-color)"
                ></i>
              </div>
              <h3 style="margin-bottom: 10px">Check Your Email</h3>
              <p style="color: var(--text-light)">
                We've sent a password reset link to your email address. Please
                check your inbox and follow the instructions.
              </p>
              <p
                style="
                  color: var(--text-light);
                  font-size: 0.9rem;
                  margin-top: 20px;
                "
              >
                Didn't receive the email?
                <a
                  href="#"
                  onclick="
                    document.getElementById(
                      'forgotPasswordForm',
                    ).style.display = 'block';
                    document.getElementById('successMessage').style.display =
                      'none';
                    return false;
                  "
                  style="color: var(--primary-color)"
                  >Try again</a
                >
              </p>
            </div>

            <div class="auth-footer" style="margin-top: 30px">
              <p>
                <a href="login.html"
                  ><i class="fas fa-arrow-left" style="margin-right: 5px"></i
                  >Back to Login</a
                >
              </p>
            </div>
          </div>

          <div class="auth-info">
            <h2>Password Security Tips</h2>
            <div class="auth-features">
              <div class="auth-feature">
                <div class="feature-icon">
                  <i class="fas fa-key"></i>
                </div>
                <div class="feature-content">
                  <h4>Use Strong Passwords</h4>
                  <p>
                    Combine uppercase, lowercase, numbers, and special
                    characters.
                  </p>
                </div>
              </div>
              <div class="auth-feature">
                <div class="feature-icon">
                  <i class="fas fa-sync-alt"></i>
                </div>
                <div class="feature-content">
                  <h4>Unique Passwords</h4>
                  <p>Use different passwords for different accounts.</p>
                </div>
              </div>
              <div class="auth-feature">
                <div class="feature-icon">
                  <i class="fas fa-shield-alt"></i>
                </div>
                <div class="feature-content">
                  <h4>Never Share</h4>
                  <p>Keep your password private and secure.</p>
                </div>
              </div>
              <div class="auth-feature">
                <div class="feature-icon">
                  <i class="fas fa-mobile-alt"></i>
                </div>
                <div class="feature-content">
                  <h4>Enable 2FA</h4>
                  <p>Add an extra layer of security to your account.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-bottom" style="border-top: none">
          <p>
            &copy; 2026 Moueene. All rights reserved. |
            <a href="privacy.html">Privacy Policy</a> |
            <a href="terms.html">Terms of Service</a>
          </p>
        </div>
      </div>
    </footer>

    <script src="../assets/js/auth.js"></script>
    <script src="../assets/js/main.js"></script>
    <script>
      // Forgot password form handling
      document
        .getElementById("forgotPasswordForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const email = document.getElementById("email").value.trim();

          // Validation
          if (!email) {
            Auth.showModal({
              type: "error",
              title: "Validation Error",
              message: "Please enter your email address.",
            });
            return;
          }

          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(email)) {
            Auth.showModal({
              type: "error",
              title: "Invalid Email",
              message: "Please enter a valid email address.",
            });
            return;
          }

          // Show loading state
          const btn = this.querySelector('button[type="submit"]');
          const originalText = btn.innerHTML;
          btn.innerHTML =
            '<i class="fas fa-spinner fa-spin" style="margin-right: 8px;"></i>Sending...';
          btn.disabled = true;

          try {
            // Try user type first, then provider
            const result = await Auth.forgotPassword(email, "user");

            // Show success message regardless (prevents email enumeration)
            document.getElementById("forgotPasswordForm").style.display =
              "none";
            document.getElementById("successMessage").style.display = "block";
          } catch (error) {
            console.error("Forgot password error:", error);
            await Auth.showModal({
              type: "error",
              title: "Connection Error",
              message: "Unable to send reset email. Please try again later.",
            });
            btn.innerHTML = originalText;
            btn.disabled = false;
          }
        });
    </script>
  </body>
</html>
