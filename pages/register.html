<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Create your Moueene account - Join as a customer or service provider"
    />
    <title>Sign Up - Moueene</title>
    <link rel="icon" type="image/png" href="../logo.png" />
    <link rel="stylesheet" href="../assets/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <nav class="navbar">
          <a href="../index.html" class="logo">
            <img src="../logo.png" alt="Moueene Logo" />
          </a>
          <ul class="nav-menu">
            <li><a href="../index.html">Home</a></li>
            <li><a href="services.html">Services</a></li>
            <li><a href="providers.html">Providers</a></li>
            <li><a href="how-it-works.html">How It Works</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
          <div class="nav-buttons">
            <a href="login.html" class="btn btn-outline">Login</a>
            <a href="register.html" class="btn btn-primary">Sign Up</a>
          </div>
          <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </nav>
      </div>
    </header>

    <!-- Auth Section -->
    <section class="auth-section">
      <div class="container">
        <div class="auth-container">
          <div class="auth-image">
            <h2>Join Moueene Today!</h2>
            <p>
              Create an account to find trusted service providers or start
              offering your services.
            </p>
            <div style="margin-top: 40px">
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 15px;
                  margin-bottom: 20px;
                "
              >
                <i class="fas fa-check-circle" style="font-size: 1.5rem"></i>
                <span>Free to sign up</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 15px;
                  margin-bottom: 20px;
                "
              >
                <i class="fas fa-check-circle" style="font-size: 1.5rem"></i>
                <span>Access thousands of providers</span>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 15px;
                  margin-bottom: 20px;
                "
              >
                <i class="fas fa-check-circle" style="font-size: 1.5rem"></i>
                <span>Secure & verified platform</span>
              </div>
              <div style="display: flex; align-items: center; gap: 15px">
                <i class="fas fa-check-circle" style="font-size: 1.5rem"></i>
                <span>24/7 customer support</span>
              </div>
            </div>
          </div>
          <div class="auth-form-container">
            <div class="auth-logo">
              <img src="../logo.png" alt="Moueene Logo" />
            </div>
            <div class="auth-form">
              <h2>Create Account</h2>

              <!-- Account Type Selection -->
              <div style="display: flex; gap: 15px; margin-bottom: 30px">
                <label
                  class="account-type-option"
                  style="
                    flex: 1;
                    padding: 15px;
                    border: 2px solid var(--border-color);
                    border-radius: 10px;
                    cursor: pointer;
                    text-align: center;
                    transition: all 0.3s;
                  "
                >
                  <input
                    type="radio"
                    name="account_type"
                    value="customer"
                    checked
                    style="display: none"
                  />
                  <i
                    class="fas fa-user"
                    style="
                      font-size: 1.5rem;
                      display: block;
                      margin-bottom: 10px;
                      color: var(--primary-color);
                    "
                  ></i>
                  <span style="font-weight: 500">Customer</span>
                </label>
                <label
                  class="account-type-option"
                  style="
                    flex: 1;
                    padding: 15px;
                    border: 2px solid var(--border-color);
                    border-radius: 10px;
                    cursor: pointer;
                    text-align: center;
                    transition: all 0.3s;
                  "
                >
                  <input
                    type="radio"
                    name="account_type"
                    value="provider"
                    style="display: none"
                  />
                  <i
                    class="fas fa-user-tie"
                    style="
                      font-size: 1.5rem;
                      display: block;
                      margin-bottom: 10px;
                      color: var(--primary-color);
                    "
                  ></i>
                  <span style="font-weight: 500">Provider</span>
                </label>
              </div>

              <form action="#" method="POST" data-validate>
                <div class="form-row">
                  <div class="form-group">
                    <label for="first_name">First Name</label>
                    <input
                      type="text"
                      id="first_name"
                      name="first_name"
                      required
                      autocomplete="given-name"
                      placeholder="John"
                    />
                  </div>
                  <div class="form-group">
                    <label for="last_name">Last Name</label>
                    <input
                      type="text"
                      id="last_name"
                      name="last_name"
                      required
                      autocomplete="family-name"
                      placeholder="Doe"
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label for="email">Email Address</label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    autocomplete="email"
                    placeholder="john@example.com"
                  />
                </div>
                <div class="form-group">
                  <label for="phone">Phone Number</label>
                  <input
                    type="tel"
                    id="phone"
                    name="phone"
                    required
                    autocomplete="tel"
                    placeholder="+1 (555) 123-4567"
                  />
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="password">Password</label>
                    <input
                      type="password"
                      id="password"
                      name="password"
                      required
                      autocomplete="new-password"
                      placeholder="Create a password"
                    />
                  </div>
                  <div class="form-group">
                    <label for="confirm_password">Confirm Password</label>
                    <input
                      type="password"
                      id="confirm_password"
                      name="confirm_password"
                      required
                      autocomplete="new-password"
                      placeholder="Confirm password"
                    />
                  </div>
                </div>
                <div class="form-check" style="margin-bottom: 20px">
                  <input type="checkbox" id="terms" name="terms" required />
                  <label for="terms"
                    >I agree to the
                    <a href="terms.html" style="color: var(--primary-color)"
                      >Terms of Service</a
                    >
                    and
                    <a href="privacy.html" style="color: var(--primary-color)"
                      >Privacy Policy</a
                    ></label
                  >
                </div>
                <button
                  type="submit"
                  class="btn btn-primary btn-lg"
                  style="width: 100%"
                >
                  Create Account
                </button>
              </form>

              <div style="text-align: center; margin: 30px 0">
                <span style="color: var(--text-light)">Or sign up with</span>
              </div>

              <div style="display: flex; gap: 15px; margin-bottom: 30px">
                <button
                  class="btn btn-outline"
                  style="
                    flex: 1;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                  "
                >
                  <i class="fab fa-google"></i> Google
                </button>
                <button
                  class="btn btn-outline"
                  style="
                    flex: 1;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                  "
                >
                  <i class="fab fa-facebook-f"></i> Facebook
                </button>
              </div>

              <div class="auth-links">
                <p>Already have an account? <a href="login.html">Sign In</a></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer" style="margin-top: 0">
      <div class="container">
        <div class="footer-bottom" style="border-top: none; padding: 25px 0">
          <p>&copy; 2026 Moueene. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/auth.js"></script>
    <script>
      // Redirect if already logged in
      if (Auth.isAuthenticated()) {
        Auth.redirectToDashboard();
      }

      // Account type selection styling
      document.querySelectorAll(".account-type-option").forEach((option) => {
        option.addEventListener("click", function () {
          document.querySelectorAll(".account-type-option").forEach((opt) => {
            opt.style.borderColor = "var(--border-color)";
            opt.style.background = "transparent";
          });
          this.style.borderColor = "var(--primary-color)";
          this.style.background = "rgba(0, 201, 167, 0.1)";
        });
      });
      // Initialize first option as selected
      document.querySelector(".account-type-option").click();

      // Handle registration form submission
      const registerForm = document.querySelector("form[data-validate]");
      registerForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Get form data
        const formData = new FormData(registerForm);
        const accountType = document.querySelector(
          'input[name="account_type"]:checked',
        ).value;
        const password = formData.get("password");
        const confirmPassword = formData.get("confirm_password");

        // Validate passwords match
        if (password !== confirmPassword) {
          await Auth.showModal({
            type: "error",
            title: "Passwords don't match",
            message: "Please make sure both password fields are the same.",
          });
          return;
        }

        // Validate password length
        if (password.length < 8) {
          await Auth.showModal({
            type: "warning",
            title: "Password too short",
            message: "Your password must be at least 8 characters long.",
          });
          return;
        }

        // Validate terms checkbox
        if (!formData.get("terms")) {
          await Auth.showModal({
            type: "warning",
            title: "Please accept the terms",
            message:
              "You must agree to the Terms of Service and Privacy Policy to create an account.",
          });
          return;
        }

        // Prepare registration data
        const userData = {
          email: formData.get("email"),
          password: password,
          first_name: formData.get("first_name"),
          last_name: formData.get("last_name"),
          phone: formData.get("phone"),
          user_type: accountType === "customer" ? "user" : "provider",
        };

        // Show loading state
        const submitButton = registerForm.querySelector(
          'button[type="submit"]',
        );
        const originalText = submitButton.textContent;
        submitButton.disabled = true;
        submitButton.innerHTML =
          '<i class="fas fa-spinner fa-spin"></i> Creating Account...';

        // Call registration API
        const result = await Auth.register(userData);

        if (result.success) {
          // Show success message
          await Auth.showModal({
            type: "success",
            title: "Account created",
            message: result.message || "Registration successful!",
          });
          // Redirect to dashboard
          Auth.redirectToDashboard();
        } else {
          // Show error message
          await Auth.showModal({
            type: "error",
            title: "Registration failed",
            message: result.message || "Registration failed. Please try again.",
          });
          // Reset button
          submitButton.disabled = false;
          submitButton.textContent = originalText;
        }
      });
    </script>
  </body>
</html>
